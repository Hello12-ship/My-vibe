<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>- Music Lounge -</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      background: #0b0b0b;
      color: #fff;
      font-family: 'Poppins', sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      height: 100vh;
      overflow: hidden;
    }

    h1 {
      margin-top: 40px;
      font-weight: 500;
      color: #e0e0e0;
      letter-spacing: 2px;
    }

    #playerContainer {
      margin-top: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    audio {
      width: 80%;
      max-width: 400px;
      margin: 20px 0;
      outline: none;
      filter: drop-shadow(0 0 10px rgba(255,255,255,0.1));
    }

    canvas {
      width: 100%;
      height: 200px;
      max-width: 600px;
    }

    ul {
      list-style: none;
      margin-top: 20px;
      width: 90%;
      max-width: 400px;
      overflow-y: auto;
      max-height: 35vh;
    }

    li {
      padding: 10px;
      border-bottom: 1px solid rgba(255,255,255,0.1);
      cursor: pointer;
      transition: 0.2s;
      text-align: center;
    }

    li:hover {
      background: rgba(255,255,255,0.1);
    }

    li.active {
      background: #1db954;
      color: #000;
      font-weight: 600;
    }

    footer {
      position: absolute;
      bottom: 10px;
      font-size: 12px;
      color: #777;
    }
  </style>
</head>
<body>
  <h1>- Music Lounge -</h1>
  <canvas id="visualizer"></canvas>

  <div id="playerContainer">
    <audio id="audio" controls></audio>
    <ul id="playlist"></ul>
  </div>

  <footer>Created by Akash</footer>

  <script>
    const songs = [
      "Aaj se teri.mp3",
      "Apa Fer Milange.mp3",
      "Bulleya.mp3",
      "Dekha ek khwab.mp3",
      "Falak Tak Chal Sath Mere.mp3",
      "Hum Tere Pyar mein.mp3",
      "Itna Na Mujhse Tu Pyaar Badha.mp3",
      "Labon Ko.mp3",
      "Mere Samnewali Khidki Mein.mp3",
      "O Re Piya.mp3",
      "Sanson Ki Mala Pe.mp3",
      "saudebaazi.mp3",
      "Toota Jo Kabhi Tara.mp3",
      "Tu Hi Haqeeqat.mp3"
    ];

    const playlist = document.getElementById("playlist");
    const audio = document.getElementById("audio");
    const canvas = document.getElementById("visualizer");
    const ctx = canvas.getContext("2d");

    canvas.width = window.innerWidth;
    canvas.height = 200;

    // Create Playlist
    songs.forEach((song, index) => {
      const li = document.createElement("li");
      li.textContent = song.replace(".mp3", "");
      li.onclick = () => playSong(index);
      playlist.appendChild(li);
    });

    let currentIndex = 0;
    const listItems = playlist.querySelectorAll("li");

    function playSong(index) {
      listItems.forEach(li => li.classList.remove("active"));
      listItems[index].classList.add("active");
      audio.src = songs[index];
      audio.play();
      currentIndex = index;
      if (audioCtx.state === "suspended") audioCtx.resume();
    }

    // Auto next
    audio.addEventListener("ended", () => {
      currentIndex = (currentIndex + 1) % songs.length;
      playSong(currentIndex);
    });

    // Audio Visualizer
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    const source = audioCtx.createMediaElementSource(audio);
    const analyser = audioCtx.createAnalyser();
    source.connect(analyser);
    analyser.connect(audioCtx.destination);
    analyser.fftSize = 512;

    const bufferLength = analyser.frequencyBinCount;
    const dataArray = new Uint8Array(bufferLength);

    function draw() {
      requestAnimationFrame(draw);
      analyser.getByteTimeDomainData(dataArray);
      ctx.fillStyle = "#0b0b0b";
      ctx.fillRect(0, 0, canvas.width, canvas.height);
      ctx.lineWidth = 2;
      ctx.strokeStyle = "#1db954";
      ctx.beginPath();

      const sliceWidth = canvas.width / bufferLength;
      let x = 0;
      for (let i = 0; i < bufferLength; i++) {
        const v = dataArray[i] / 128.0;
        const y = (v * canvas.height) / 2;
        if (i === 0) ctx.moveTo(x, y);
        else ctx.lineTo(x, y);
        x += sliceWidth;
      }
      ctx.lineTo(canvas.width, canvas.height / 2);
      ctx.stroke();
    }
    draw();

    // Auto play first song
    playSong(0);
  </script>
</body>
</html>
